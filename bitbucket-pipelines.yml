image: mcr.microsoft.com/azure-cli:latest

pipelines:
  default:
    - step:
        name: Deploy to Azure
        script:
          - az login --service-principal -u $AZURE_SP_APP_ID -p $AZURE_SP_SECRET --tenant $AZURE_SP_TENANT_ID
          - az functionapp deployment source config --name <your-function-app-name> --resource-group <your-resource-group> --repo-url https://<bitbucket-username>@bitbucket.org/<bitbucket-repo>/<bitbucket-repo.git> --branch <your-branch> --manual-integration
          - az functionapp deployment source sync --name <your-function-app-name> --resource-group <your-resource-group>